---
format: dashboard
---

<script>
document.addEventListener('DOMContentLoaded', (event) => {
  document.getElementById('nav-data-overview').classList.add('active');
});
</script>

```{r setup, include=FALSE}
source("library.R")
```

```{r data, include=FALSE}
list_column <- readRDS("/home/rstudio/Data/object/list_column.rds")
```

# Layout

```{r data-1}
df_layout <- list_column$layout
```

::: {.panel-tabset}

## 전체

```{r reactable-1}
df_layout %>% 
  select(COLUMN, 비고, AINQ:RSLT, starts_with("N_")) %>% 
  mutate(COLUMN = gsub("\\(.*\\)","",COLUMN)) %>%
  f_reactable(columns = list(
    COLUMN = colDef(name = "Column", style = f_style_bold),
    비고   = colDef(name = "비고"),
    AINQ   = colDef(name = "AINQ"),
    JUDD   = colDef(name = "JUDD"),
    RSLT   = colDef(name = "RSLT"),
    N_ALL  = colDef(style = f_style1),
    N_AINQ = colDef(style = f_style2),
    N_JUDD = colDef(style = f_style2),
    N_RSLT = colDef(style = f_style2)
  )
)
```

:::

# PACS

```{r data-2, include=FALSE}
df_pacs <- read_csv("/home/rstudio/Data/meta/240729_PACS 비정형 데이터 보유 현황_살루스케어.csv")
#status_PACS <- readRDS("/home/rstudio/Data/object/status_PACS.rds")
```

::: {.panel-tabset}

## MODALITY

```{r}
modalities <- df_pacs %>% 
  count(`검사구분(MODALITY)`, sort = TRUE) %>% 
  pull(`검사구분(MODALITY)`)
```

::: {.panel-tabset}


### 복부 외 초음파 (US)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'US') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### CT

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'CT') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### MRI/MRA (MR)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'MR') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 유방촬영 외 X-ray (DR)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'DR') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 내시경 (ES)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'ES') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 골밀도 (OT)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'OT') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### PET CT (PT)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'PT') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 심전도 (EK)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'EK') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 유방촬영 (MG)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'MG') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 위장조영 (RF)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'RF') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 동맥경화도 (VS)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'VS') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### 안저안압 (XC)

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'XC') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### EKG

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'EKG') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

### OP

```{r}
df_pacs %>%
  filter(`검사구분(MODALITY)` == 'OP') %>%
  f_reactable(
    groupBy = c("검사명１"),
    pagination=FALSE
  )
```

:::

## CENTER

::: {.panel-tabset}

```{r}
centers <- df_pacs %>% 
  count(SALUS_CENTER, sort = TRUE) %>% 
  pull(SALUS_CENTER)

for(center in centers) {
  cat(paste0("### ", center, "\n\n"))
  df_pacs %>% 
    filter(SALUS_CENTER == center) %>%
    head(10) %>%
    reactable()
  
  cat("\n\n")
}
```


:::

:::

